###############################################################################
###############################################################################
####                                                                       ####
####              THIS FILE WAS GENERATED WITH nr cli config               ####
####                       DO NOT EDIT IT MANUALLY!                        ####
####                                                                       ####
###############################################################################
###############################################################################

###############################################################################
# Default provider.
###############################################################################
provider "aws" {
  default_tags {
    tags = {
      Terraform = true
    }
  }
  region  = module.global.config.organization.aws_region
}

###############################################################################
# Create a provider to assume the OrganizationAccountAccessRole role on the 
# Terraform state account.
###############################################################################
provider "aws" {
  alias   = "terraform_state_account"
  assume_role {
    role_arn = "arn:aws:iam::${aws_organizations_account.accounts["{{terraform.state_account}}"].id}:role/OrganizationAccountAccessRole"
  }
  default_tags {
    tags = {
      Terraform = true
    }
  }
  region = module.global.config.organization.aws_region
}
{{#each accounts}}{{#if (logic "not" (lodash "eq" this.action "destroy"))}}
###############################################################################
# Create a provider to assume the OrganizationAccountAccessRole role on account 
# "{{this.name}}".
###############################################################################
provider "aws" {
  alias   = "{{@key}}" {{#if (lodash "eq" @key ../organization.master_account)}} {{else}}
  assume_role {
    role_arn = "arn:aws:iam::${try(aws_organizations_account.accounts["{{@key}}"].id, module.global.config.accounts["{{@key}}"].id)}:role/OrganizationAccountAccessRole"
  } {{/if}}
  default_tags {
    tags = {
      Terraform = true
    }
  }
  region = module.global.config.organization.aws_region
}
{{/if}}{{/each}}